var fs = require('fs')
var errorlog = fs.createWriteStream(process.cwd()+'/node.error.log', { flags: 'a' });
process.stderr.write = errorlog.write.bind(errorlog)
var heapdump = null

//returns server kernel object !!! WARN includes its own mongodb client
module.exports.initServerKernel = function(task){
	var kernel = require('./kernel.js')
	kernel.init(task)
	return kernel
}

//return mongodb client
module.exports.initMongoClient = function(connect,callback){
	var mongo = require('./nevod-mongo-client.js')
	if(connect){
		mongo.connect(function(err){
			if(err) return null
			callback(mongo)
		})
	} else {
		callback(mongo)
	}
}

module.exports.getUranParser = function(){
	var parser = require('./parser.js')
	return parser
}

module.exports.getTextSysLib = function(){
	var txtsyslib = require('./textsys.js')
	return txtsyslib
}

module.exports.getUranMathLib = function(){
	var uran_math = require('./uran_math.js')
	return uran_math
}

module.exports.runMemoryTest = function(callback){
	heapdump = require('./heapdump.js')
	heapdump.init(callback)
}

module.exports.stopMemoryTest = function(){
	heapdump = null
}

module.exports.getLogger = function(){
	var logger = require('./logger.js')
	return logger
}
