var heapdump = null

//returns server kernel object !!! WARN includes its own mongodb client
module.exports.initServerKernel = function(task){
  var kernel = require('./kernel.js')
  kernel.init(task)
  kernel.load()
  return kernel
}

//return mongodb client
module.exports.initMongoClient = function(connect){
  var mongo = require('./mongodb_client.js')
  if(connect){
    mongo.connect(function(err){
      if(err) return null
      return mongo
    })
  } else {
    return mongo
  }
}

module.exports.runMemoryTest = function(callback){
  heapdump = require('./heapdump.js')
  heapdump.init(callback)
}

module.exports.stopMemoryTest = function(){
  heapdump = null
}
